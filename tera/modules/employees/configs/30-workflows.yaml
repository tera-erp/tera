# Workflows, actions, and state management
workflows:
  employee_workflow:
    title: Employee Lifecycle
    initial_state: active
    states:
      active:
        label: Active
        color: green
        can_transition_to: [inactive, terminated]
        allow_edit: true
        allow_delete: false

      inactive:
        label: Inactive
        color: yellow
        can_transition_to: [active, terminated]
        allow_edit: false
        allow_delete: false

      terminated:
        label: Terminated
        color: red
        can_transition_to: []
        allow_edit: false
        allow_delete: false

    transitions:
      deactivate:
        from: active
        to: inactive
        label: Deactivate Employee
        action: payroll.deactivate_employee
        confirm_message: Deactivate this employee?
        permissions: [payroll.manage_employee]

      reactivate:
        from: inactive
        to: active
        label: Reactivate Employee
        action: payroll.reactivate_employee
        permissions: [payroll.manage_employee]

      terminate:
        from: active
        to: terminated
        label: Terminate Employment
        action: payroll.terminate_employee
        confirm_message: Terminate this employee? This cannot be undone.
        permissions: [payroll.manage_employee]

actions:
  deactivate_employee:
    type: api
    method: POST
    endpoint: /api/v1/employees/{id}/deactivate
    success_message: Employee deactivated
    error_message: Failed to deactivate employee
    on_success:
      - action: refresh_form

  reactivate_employee:
    type: api
    method: POST
    endpoint: /api/v1/employees/{id}/reactivate
    success_message: Employee reactivated
    error_message: Failed to reactivate employee
    on_success:
      - action: refresh_form

  terminate_employee:
    type: api
    method: POST
    endpoint: /api/v1/employees/{id}/terminate
    success_message: Employee terminated
    error_message: Failed to terminate employee
    on_success:
      - action: navigate_to
        target: /modules/payroll/employees

